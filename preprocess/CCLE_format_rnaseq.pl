#!/usr/bin/perl

# Copyright (c) 2018 Los Alamos National Security, LLC.
# All rights reserved.
# 
# Copyright 2018. Los Alamos National Security, LLC. This software was produced under U.S. Government 
# contract DE-AC52-06NA25396 for Los Alamos National Laboratory (LANL), which is operated by Los Alamos 
# National Security, LLC for the U.S. Department of Energy. The U.S. Government has rights to use, 
# reproduce, and distribute this software.  NEITHER THE GOVERNMENT NOR LOS ALAMOS NATIONAL SECURITY, LLC 
# MAKES ANY WARRANTY, EXPRESS OR IMPLIED, OR ASSUMES ANY LIABILITY FOR THE USE OF THIS SOFTWARE.  If 
# software is modified to produce derivative works, such modified software should be clearly marked, so 
# as not to confuse it with the version available from LANL.
# 
# This work has been supported in part by the Joint Design of Advanced Computing Solutions for Cancer 
# (JDACS4C) program established by the U.S. Department of Energy (DOE) and the National Cancer Institute 
# (NCI) of the National Institutes of Health. 
# 
# Permission is hereby granted, free of charge, to any person obtaining a copy of this software and 
# associated documentation files (the "Software"), to deal in the Software without restriction, including 
# without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell 
# copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to 
# the following conditions: 
# 
# The above copyright notice and this permission notice shall be included in all copies or substantial 
# portions of the Software.
# 
# THIS SOFTWARE IS PROVIDED BY LOS ALAMOS NATIONAL SECURITY, LLC AND CONTRIBUTORS "AS IS" AND ANY EXPRESS 
# OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND 
# FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL LOS ALAMOS NATIONAL SECURITY, LLC OR 
# CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
# (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; 
# OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
# LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, 
# EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
#
# Author: Jason D. Gans (jgans@lanl.gov)

use strict;

my %lincs = (
	"ID" => 0,
	"INSIG1" => 0,
	"FOXO3" => 0,
	"CDH3" => 0,
	"ORC1" => 0,
	"ITGAE" => 0,
	"CDK7" => 0,
	"FOS" => 0,
	"CDK6" => 0,
	"CDK4" => 0,
	"CDK2" => 0,
	"ITGB5" => 0,
	"CDKN2A" => 0,
	"CDKN1B" => 0,
	"CDKN1A" => 0,
	"FPGS" => 0,
	"CEBPD" => 0,
	"CEBPA" => 0,
	"CENPE" => 0,
	"MICALL1" => 0,
	"CETN3" => 0,
	"UBE2C" => 0,
	"DUSP14" => 0,
	"TOPBP1" => 0,
	"B4GAT1" => 0,
	"RBM34" => 0,
	"PAPD7" => 0,
	"WDTC1" => 0,
	"XPO7" => 0,
	"AKAP8L" => 0,
	"RAB31" => 0,
	"SPEN" => 0,
	"FBXO21" => 0,
	"RAB21" => 0,
	"SLC27A3" => 0,
	"KIF2C" => 0,
	"CCDC85B" => 0,
	"TLK2" => 0,
	"KDELR2" => 0,
	"MCUR1" => 0,
	"CDK19" => 0,
	"JUN" => 0,
	"TBC1D9B" => 0,
	"PRSS23" => 0,
	"RRP1B" => 0,
	"MYCBP2" => 0,
	"CHEK1" => 0,
	"KCNK1" => 0,
	"CHN1" => 0,
	"CIRBP" => 0,
	"HDGFRP3" => 0,
	"COPS7A" => 0,
	"NSDHL" => 0,
	"ATP11B" => 0,
	"PRAF2" => 0,
	"JMJD6" => 0,
	"RRS1" => 0,
	"MPC2" => 0,
	"ARID5B" => 0,
	"POLG2" => 0,
	"CHEK2" => 0,
	"BACE2" => 0,
	"COG4" => 0,
	"SPDEF" => 0,
	"BAMBI" => 0,
	"SPRED2" => 0,
	"SLC2A6" => 0,
	"SNX13" => 0,
	"NISCH" => 0,
	"AARS" => 0,
	"ABCF1" => 0,
	"ABL1" => 0,
	"FCHO1" => 0,
	"DCUN1D4" => 0,
	"PSIP1" => 0,
	"ACAA1" => 0,
	"ACAT2" => 0,
	"ACLY" => 0,
	"PKIG" => 0,
	"CORO1A" => 0,
	"MAST2" => 0,
	"GPATCH8" => 0,
	"FBXO7" => 0,
	"LSM6" => 0,
	"PWP1" => 0,
	"KIF5C" => 0,
	"KIT" => 0,
	"FUT1" => 0,
	"FYN" => 0,
	"GAA" => 0,
	"CLTC" => 0,
	"CLTB" => 0,
	"SLC37A4" => 0,
	"GABPB1" => 0,
	"KTN1" => 0,
	"GALE" => 0,
	"GAPDH" => 0,
	"COL4A1" => 0,
	"COL1A1" => 0,
	"TRIM2" => 0,
	"TSKU" => 0,
	"WASHC4" => 0,
	"KIAA1033" => 0,
	"USP22" => 0,
	"HDAC6" => 0,
	"TWF2" => 0,
	"WDR7" => 0,
	"JADE2" => 0,
	"ATMIN" => 0,
	"C2CD2" => 0,
	"DDX42" => 0,
	"TIPARP" => 0,
	"GNPDA1" => 0,
	"ECD" => 0,
	"CLIC4" => 0,
	"PNKP" => 0,
	"CAMSAP2" => 0,
	"CHP1" => 0,
	"PDS5A" => 0,
	"RRP12" => 0,
	"SYNE2" => 0,
	"LAMA3" => 0,
	"STMN1" => 0,
	"LBR" => 0,
	"HEBP1" => 0,
	"GATA3" => 0,
	"GATA2" => 0,
	"LGALS8" => 0,
	"LIG1" => 0,
	"LIPA" => 0,
	"GFPT1" => 0,
	"GHR" => 0,
	"CREB1" => 0,
	"RPL39L" => 0,
	"CRKL" => 0,
	"CRK" => 0,
	"SLC35A3" => 0,
	"TRAP1" => 0,
	"G3BP1" => 0,
	"KIF20A" => 0,
	"ARL4C" => 0,
	"SIRT3" => 0,
	"TSPAN3" => 0,
	"NUDCD3" => 0,
	"SMC4" => 0,
	"ARHGEF12" => 0,
	"PPP1R13B" => 0,
	"ABCC5" => 0,
	"DNM1L" => 0,
	"ABCB6" => 0,
	"RRP8" => 0,
	"PARP2" => 0,
	"MAMLD1" => 0,
	"DNAJB6" => 0,
	"GLI2" => 0,
	"GLRX" => 0,
	"CRYZ" => 0,
	"GNAI2" => 0,
	"GNAI1" => 0,
	"GNA11" => 0,
	"GNA15" => 0,
	"GNAS" => 0,
	"CSK" => 0,
	"CSNK2A2" => 0,
	"CSNK1E" => 0,
	"CSNK1A1" => 0,
	"CSRP1" => 0,
	"SLC35B1" => 0,
	"TIMM17B" => 0,
	"KAT6B" => 0,
	"NNT" => 0,
	"ADAT1" => 0,
	"MFSD10" => 0,
	"TRIB1" => 0,
	"SUZ12" => 0,
	"TRIM13" => 0,
	"TXNDC9" => 0,
	"FASTKD5" => 0,
	"SORBS3" => 0,
	"RBM6" => 0,
	"MACF1" => 0,
	"MBNL2" => 0,
	"ICMT" => 0,
	"CEBPZ" => 0,
	"SFN" => 0,
	"SLC25A13" => 0,
	"GPC1" => 0,
	"CTNND1" => 0,
	"CTSD" => 0,
	"CTSL" => 0,
	"GPER1" => 0,
	"CYB561" => 0,
	"GRB10" => 0,
	"GRB7" => 0,
	"GRN" => 0,
	"TMEM2" => 0,
	"HMG20B" => 0,
	"ARFIP2" => 0,
	"LSM5" => 0,
	"PLA2G15" => 0,
	"TNIP1" => 0,
	"NUP62" => 0,
	"SSBP2" => 0,
	"TMEM5" => 0,
	"IKZF1" => 0,
	"NR3C1" => 0,
	"PAK4" => 0,
	"AKAP8" => 0,
	"STUB1" => 0,
	"TMEM50A" => 0,
	"KLHDC2" => 0,
	"CXCL2" => 0,
	"NET1" => 0,
	"ACOT9" => 0,
	"SMNDC1" => 0,
	"DAG1" => 0,
	"DAXX" => 0,
	"GSTM2" => 0,
	"GSTZ1" => 0,
	"GTF2A2" => 0,
	"MSH6" => 0,
	"ELAC2" => 0,
	"DCTD" => 0,
	"DCK" => 0,
	"GTF2E2" => 0,
	"DDB2" => 0,
	"GADD45A" => 0,
	"DECR1" => 0,
	"DDX10" => 0,
	"DFFB" => 0,
	"DFFA" => 0,
	"CRTAP" => 0,
	"VAT1" => 0,
	"STK25" => 0,
	"LRRC41" => 0,
	"VAV3" => 0,
	"PPIE" => 0,
	"LYPLA1" => 0,
	"MYL9" => 0,
	"DLD" => 0,
	"TUBB6" => 0,
	"DNM1" => 0,
	"CIAPIN1" => 0,
	"DNMT3A" => 0,
	"DNMT1" => 0,
	"PLSCR3" => 0,
	"TXLNA" => 0,
	"APPBP2" => 0,
	"HYOU1" => 0,
	"CHERP" => 0,
	"SNX6" => 0,
	"THAP11" => 0,
	"DRAP1" => 0,
	"RPP38" => 0,
	"SLC35A1" => 0,
	"MCOLN1" => 0,
	"DPH2" => 0,
	"DSG2" => 0,
	"TSC22D3" => 0,
	"DUSP6" => 0,
	"DUSP4" => 0,
	"DUSP3" => 0,
	"PSRC1" => 0,
	"TOR1A" => 0,
	"E2F2" => 0,
	"ECH1" => 0,
	"SQRDL" => 0,
	"LYRM1" => 0,
	"SCYL3" => 0,
	"ENOPH1" => 0,
	"PRUNE1" => 0,
	"ZMIZ1" => 0,
	"YKT6" => 0,
	"CGRRF1" => 0,
	"NPRL2" => 0,
	"IGF2BP2" => 0,
	"STAMBP" => 0,
	"ST6GALNAC2" => 0,
	"PAICS" => 0,
	"CNPY3" => 0,
	"RRAGA" => 0,
	"EBP" => 0,
	"GNB5" => 0,
	"H2AFV" => 0,
	"EDN1" => 0,
	"EGF" => 0,
	"EGR1" => 0,
	"EGFR" => 0,
	"EIF4EBP1" => 0,
	"EIF5" => 0,
	"EIF4G1" => 0,
	"ELAVL1" => 0,
	"MPZL1" => 0,
	"SLC25A14" => 0,
	"MAP7" => 0,
	"ADO" => 0,
	"ARPP19" => 0,
	"POP4" => 0,
	"ZNF274" => 0,
	"ABHD6" => 0,
	"DNAJA3" => 0,
	"USP14" => 0,
	"KDM5B" => 0,
	"YME1L1" => 0,
	"TCFL5" => 0,
	"CASC3" => 0,
	"COG2" => 0,
	"MTHFD2" => 0,
	"EML3" => 0,
	"MTA1" => 0,
	"PDLIM1" => 0,
	"PRPF4" => 0,
	"SMC3" => 0,
	"CCNB2" => 0,
	"CCNE2" => 0,
	"SYNGR3" => 0,
	"LPAR2" => 0,
	"ZW10" => 0,
	"ARHGEF2" => 0,
	"CPSF4" => 0,
	"MALT1" => 0,
	"KIAA0907" => 0,
	"CLSTN1" => 0,
	"FOXJ3" => 0,
	"PGRMC1" => 0,
	"CANT1" => 0,
	"RAB11FIP2" => 0,
	"ATF5" => 0,
	"MTF2" => 0,
	"PUF60" => 0,
	"CLPX" => 0,
	"AURKB" => 0,
	"VAPB" => 0,
	"NOLC1" => 0,
	"WASF3" => 0,
	"UTP14A" => 0,
	"FRS2" => 0,
	"GRWD1" => 0,
	"UBE2L6" => 0,
	"CYTH1" => 0,
	"MAPKAPK2" => 0,
	"COPB2" => 0,
	"ITGB1BP1" => 0,
	"BCL7B" => 0,
	"ADGRG1" => 0,
	"HERC6" => 0,
	"TMED10" => 0,
	"ASCC3" => 0,
	"PPP2R3C" => 0,
	"PIH1D1" => 0,
	"RPIA" => 0,
	"PDIA5" => 0,
	"TOMM34" => 0,
	"FKBP14" => 0,
	"EBNA1BP2" => 0,
	"CDCA4" => 0,
	"MLLT11" => 0,
	"WIPF2" => 0,
	"SACM1L" => 0,
	"ATF6" => 0,
	"TCERG1" => 0,
	"TM9SF2" => 0,
	"EPN2" => 0,
	"RNPS1" => 0,
	"PDHX" => 0,
	"FOSL1" => 0,
	"BLCAP" => 0,
	"HMGA2" => 0,
	"TRIB3" => 0,
	"PLEKHJ1" => 0,
	"HEATR1" => 0,
	"ANO10" => 0,
	"UBR7" => 0,
	"TRAPPC6A" => 0,
	"CHAC1" => 0,
	"CCDC86" => 0,
	"MAP4K4" => 0,
	"HOMER2" => 0,
	"SH3BP5" => 0,
	"METRN" => 0,
	"PIGB" => 0,
	"PSMF1" => 0,
	"ELOVL6" => 0,
	"TMEM109" => 0,
	"ITFG1" => 0,
	"FBXO11" => 0,
	"ADI1" => 0,
	"CCDC92" => 0,
	"GDPD5" => 0,
	"POLD4" => 0,
	"SPTLC2" => 0,
	"TBPL1" => 0,
	"BAG3" => 0,
	"NRIP1" => 0,
	"NCOA3" => 0,
	"POLR1C" => 0,
	"SPAG7" => 0,
	"SMC1A" => 0,
	"FAIM" => 0,
	"LAGE3" => 0,
	"MBOAT7" => 0,
	"PRR15L" => 0,
	"CRELD2" => 0,
	"MAPK1IP1L" => 0,
	"FSD1" => 0,
	"NPDC1" => 0,
	"ABCF3" => 0,
	"ERO1A" => 0,
	"TRAK2" => 0,
	"COASY" => 0,
	"CHMP4A" => 0,
	"GTPBP8" => 0,
	"IKBKE" => 0,
	"AXIN1" => 0,
	"FEZ2" => 0,
	"FZD1" => 0,
	"HS2ST1" => 0,
	"MTFR1" => 0,
	"FZD7" => 0,
	"CDC45" => 0,
	"TERT" => 0,
	"TESK1" => 0,
	"IPO13" => 0,
	"VGLL4" => 0,
	"TFDP1" => 0,
	"NUP93" => 0,
	"TFAP2A" => 0,
	"HIST2H2BE" => 0,
	"TRAM2" => 0,
	"EDEM1" => 0,
	"UBE3C" => 0,
	"TGFB3" => 0,
	"TGFBR2" => 0,
	"PIP4K2B" => 0,
	"TIMP2" => 0,
	"TIAM1" => 0,
	"TLE1" => 0,
	"TJP1" => 0,
	"TBC1D31" => 0,
	"TLR4" => 0,
	"DNAJC15" => 0,
	"TICAM1" => 0,
	"USP6NL" => 0,
	"KIAA0355" => 0,
	"CEP57" => 0,
	"KIAA0100" => 0,
	"HERPUD1" => 0,
	"ADAM10" => 0,
	"CCP110" => 0,
	"ADH5" => 0,
	"MLEC" => 0,
	"TSPAN6" => 0,
	"NCK2" => 0,
	"DUSP11" => 0,
	"DYRK3" => 0,
	"PARP1" => 0,
	"TSPAN4" => 0,
	"ADRB2" => 0,
	"TATDN2" => 0,
	"AGL" => 0,
	"TOP2A" => 0,
	"TP53BP1" => 0,
	"TP53" => 0,
	"TP53BP2" => 0,
	"RAE1" => 0,
	"TPD52L2" => 0,
	"TPM1" => 0,
	"WDR61" => 0,
	"MRPL19" => 0,
	"SCRN1" => 0,
	"EFCAB14" => 0,
	"KEAP1" => 0,
	"MELK" => 0,
	"AKT1" => 0,
	"CYCS" => 0,
	"PLEKHM1" => 0,
	"ALAS1" => 0,
	"PIK3R3" => 0,
	"NIPSNAP1" => 0,
	"HAT1" => 0,
	"KIAA0753" => 0,
	"C2CD2L" => 0,
	"ENOSF1" => 0,
	"ALDOA" => 0,
	"C2CD5" => 0,
	"TM9SF3" => 0,
	"IKBKAP" => 0,
	"ALDOC" => 0,
	"TOMM70" => 0,
	"BHLHE40" => 0,
	"MAPKAPK5" => 0,
	"WASHC5" => 0,
	"KIAA0196" => 0,
	"AKR7A2" => 0,
	"CASK" => 0,
	"MKNK1" => 0,
	"TSTA3" => 0,
	"SLC25A4" => 0,
	"SLC25A46" => 0,
	"TXNRD1" => 0,
	"CHMP6" => 0,
	"IARS2" => 0,
	"TERF2IP" => 0,
	"ACD" => 0,
	"CARMIL1" => 0,
	"ANKRD10" => 0,
	"DUSP22" => 0,
	"KLHL21" => 0,
	"STAP2" => 0,
	"FAM20B" => 0,
	"NCAPD2" => 0,
	"ARNT2" => 0,
	"PAN2" => 0,
	"KIF14" => 0,
	"LPGAT1" => 0,
	"OXSR1" => 0,
	"ANXA7" => 0,
	"RUVBL1" => 0,
	"APBB2" => 0,
	"TCTN1" => 0,
	"BIRC2" => 0,
	"MVP" => 0,
	"BIRC5" => 0,
	"COQ8A" => 0,
	"PSMG1" => 0,
	"APOE" => 0,
	"APP" => 0,
	"FAS" => 0,
	"UBE2A" => 0,
	"DMTF1" => 0,
	"BECN1" => 0,
	"RHEB" => 0,
	"UGDH" => 0,
	"RHOA" => 0,
	"ARHGAP1" => 0,
	"NR1H2" => 0,
	"RNH1" => 0,
	"USP1" => 0,
	"PAK6" => 0,
	"INTS3" => 0,
	"PRR7" => 0,
	"TMEM110" => 0,
	"TSEN2" => 0,
	"TMCO1" => 0,
	"CNDP2" => 0,
	"NUP133" => 0,
	"NPEPL1" => 0,
	"MBTPS1" => 0,
	"ASAH1" => 0,
	"RNMT" => 0,
	"EED" => 0,
	"GFOD1" => 0,
	"CTNNAL1" => 0,
	"KCTD5" => 0,
	"VDAC1" => 0,
	"MINDY1" => 0,
	"FAM63A" => 0,
	"ATF1" => 0,
	"ATP1B1" => 0,
	"RPA1" => 0,
	"RPA3" => 0,
	"RPA2" => 0,
	"WFS1" => 0,
	"WRB" => 0,
	"XBP1" => 0,
	"MRPL12" => 0,
	"RPN1" => 0,
	"RPS5" => 0,
	"RPS6KA1" => 0,
	"RPS6" => 0,
	"FAM69A" => 0,
	"ALDH7A1" => 0,
	"EXOSC4" => 0,
	"CISD1" => 0,
	"PEX11A" => 0,
	"CREG1" => 0,
	"INPP4B" => 0,
	"ATP6V0B" => 0,
	"IQGAP1" => 0,
	"XPNPEP1" => 0,
	"DDIT4" => 0,
	"SOCS2" => 0,
	"CFLAR" => 0,
	"CDK5R1" => 0,
	"FAM57A" => 0,
	"ZNF395" => 0,
	"IER3" => 0,
	"BAD" => 0,
	"ST3GAL5" => 0,
	"ZFP36" => 0,
	"SLC5A6" => 0,
	"BAX" => 0,
	"SQSTM1" => 0,
	"CPNE3" => 0,
	"CCND1" => 0,
	"BCL2" => 0,
	"RSU1" => 0,
	"RTN2" => 0,
	"S100A4" => 0,
	"S100A13" => 0,
	"KDM3A" => 0,
	"PECR" => 0,
	"DHX29" => 0,
	"EAPP" => 0,
	"TRAPPC3" => 0,
	"RBKS" => 0,
	"CCNA1" => 0,
	"ATP2C1" => 0,
	"BDH1" => 0,
	"TIMELESS" => 0,
	"BID" => 0,
	"BLMH" => 0,
	"BLVRA" => 0,
	"TCEAL4" => 0,
	"BMP4" => 0,
	"BNIP3" => 0,
	"BNIP3L" => 0,
	"DHDDS" => 0,
	"P4HA2" => 0,
	"BPHL" => 0,
	"BRCA1" => 0,
	"NUDT9" => 0,
	"SATB1" => 0,
	"PLOD3" => 0,
	"P4HTM" => 0,
	"DENND2D" => 0,
	"NOL3" => 0,
	"BTK" => 0,
	"SCP2" => 0,
	"CCL2" => 0,
	"OXA1L" => 0,
	"OXCT1" => 0,
	"ZNF131" => 0,
	"PAFAH1B1" => 0,
	"SERPINE1" => 0,
	"PAK1" => 0,
	"PAFAH1B3" => 0,
	"SDHB" => 0,
	"PCCB" => 0,
	"PCBD1" => 0,
	"NUP85" => 0,
	"PAF1" => 0,
	"KLHL9" => 0,
	"BUB1B" => 0,
	"C5" => 0,
	"ZMYM2" => 0,
	"DDR1" => 0,
	"PCMT1" => 0,
	"PCNA" => 0,
	"SGCB" => 0,
	"PCK2" => 0,
	"PCM1" => 0,
	"SHB" => 0,
	"SHC1" => 0,
	"PDGFA" => 0,
	"SKIV2L" => 0,
	"SLC35F2" => 0,
	"ATP5S" => 0,
	"PACSIN3" => 0,
	"CALM3" => 0,
	"CALU" => 0,
	"CAPN1" => 0,
	"CAST" => 0,
	"CASP2" => 0,
	"CASP3" => 0,
	"CASP7" => 0,
	"CASP10" => 0,
	"CAT" => 0,
	"SKP1" => 0,
	"CBLB" => 0,
	"SLC1A4" => 0,
	"CBR1" => 0,
	"CBR3" => 0,
	"CXCR4" => 0,
	"TEX10" => 0,
	"PAX8" => 0,
	"CCNA2" => 0,
	"CCNB1" => 0,
	"CCND3" => 0,
	"CCNF" => 0,
	"PFKL" => 0,
	"USP7" => 0,
	"IFRD2" => 0,
	"MAPKAPK3" => 0,
	"PGAM1" => 0,
	"PGM1" => 0,
	"PHKA1" => 0,
	"PHKB" => 0,
	"PHKG2" => 0,
	"SMARCA4" => 0,
	"SMARCC1" => 0,
	"ZNF586" => 0,
	"PIK3C2B" => 0,
	"PIK3C3" => 0,
	"PIK3CA" => 0,
	"FBXL12" => 0,
	"TNFRSF21" => 0,
	"SESN1" => 0,
	"RBM15B" => 0,
	"PIK3R4" => 0,
	"CCNH" => 0,
	"DNTTIP2" => 0,
	"SCCPDH" => 0,
	"SCARB1" => 0,
	"REEP5" => 0,
	"CD40" => 0,
	"CD44" => 0,
	"CD58" => 0,
	"SENP6" => 0,
	"ADGRE5" => 0,
	"CD97" => 0,
	"SMARCD2" => 0,
	"RAI14" => 0,
	"CDK1" => 0,
	"SNAP25" => 0,
	"PIN1" => 0,
	"CDC20" => 0,
	"CDC25A" => 0,
	"CDC25B" => 0,
	"MTERF3" => 0,
	"CDC42" => 0,
	"AMDHD2" => 0,
	"SNCA" => 0,
	"ISOC1" => 0,
	"PLA2G4A" => 0,
	"ST7" => 0,
	"MRPS16" => 0,
	"FIS1" => 0,
	"GOLT1B" => 0,
	"COG7" => 0,
	"PLCB3" => 0,
	"KAT6A" => 0,
	"GLOD4" => 0,
	"SOX2" => 0,
	"SOX4" => 0,
	"SPAG4" => 0,
	"PLP2" => 0,
	"GMNN" => 0,
	"LAP3" => 0,
	"LOXL1" => 0,
	"PLK1" => 0,
	"SPP1" => 0,
	"PMAIP1" => 0,
	"SPR" => 0,
	"PLS1" => 0,
	"PLSCR1" => 0,
	"PMM2" => 0,
	"LRPAP1" => 0,
	"NOSIP" => 0,
	"DERA" => 0,
	"YTHDF1" => 0,
	"LYN" => 0,
	"TIMM22" => 0,
	"SMAD3" => 0,
	"NENF" => 0,
	"TXNL4B" => 0,
	"HOOK2" => 0,
	"SNX11" => 0,
	"ZNF451" => 0,
	"TMEM97" => 0,
	"LRP10" => 0,
	"HTATSF1" => 0,
	"RNF167" => 0,
	"UBQLN2" => 0,
	"SPTAN1" => 0,
	"SRC" => 0,
	"POLB" => 0,
	"POLE2" => 0,
	"POLR2K" => 0,
	"STAT1" => 0,
	"STAT3" => 0,
	"POLR2I" => 0,
	"STAT5B" => 0,
	"AURKA" => 0,
	"STK10" => 0,
	"VPS28" => 0,
	"MAN2B1" => 0,
	"MAT2A" => 0,
	"HSD17B11" => 0,
	"PPARD" => 0,
	"PPARG" => 0,
	"MBNL1" => 0,
	"PPIC" => 0,
	"PPOX" => 0,
	"MCM3" => 0,
	"ATG3" => 0,
	"ZDHHC6" => 0,
	"NARFL" => 0,
	"MRPS2" => 0,
	"TES" => 0,
	"KIF1BP" => 0,
	"STX1A" => 0,
	"STX4" => 0,
	"STXBP1" => 0,
	"STXBP2" => 0,
	"SUV39H1" => 0,
	"SUPV3L1" => 0,
	"SYK" => 0,
	"MYCBP" => 0,
	"ME2" => 0,
	"SYPL1" => 0,
	"PPP2R5A" => 0,
	"PPP2R5E" => 0,
	"MEF2C" => 0,
	"MAP3K4" => 0,
	"PRCP" => 0,
	"TARBP1" => 0,
	"MEST" => 0,
	"HN1L" => 0,
	"PRKACA" => 0,
	"PRKCD" => 0,
	"PRKCH" => 0,
	"SCAND1" => 0,
	"CD320" => 0,
	"PRKCQ" => 0,
	"MIF" => 0,
	"NUSAP1" => 0,
	"PHGDH" => 0,
	"TBP" => 0,
	"TBX2" => 0,
	"TCEA2" => 0,
	"TBXA2R" => 0,
	"MAP2K5" => 0,
	"MAPK9" => 0,
	"MAPK13" => 0,
	"VPS72" => 0,
	"PRKX" => 0,
	"PROS1" => 0,
	"LGMN" => 0,
	"FOXO4" => 0,
	"MMP1" => 0,
	"MMP2" => 0,
	"DYNLT3" => 0,
	"MNAT1" => 0,
	"HTRA1" => 0,
	"TCTA" => 0,
	"SNX7" => 0,
	"ATP6V1D" => 0,
	"ZNF589" => 0,
	"PSMB8" => 0,
	"HADH" => 0,
	"HSD17B10" => 0,
	"PSMB10" => 0,
	"HDAC2" => 0,
	"HIF1A" => 0,
	"HK1" => 0,
	"UBE3B" => 0,
	"BZW2" => 0,
	"NGRN" => 0,
	"PSMD2" => 0,
	"PSMD4" => 0,
	"PSMD9" => 0,
	"PSMD10" => 0,
	"PSME1" => 0,
	"PSME2" => 0,
	"PTGS2" => 0,
	"PTK2" => 0,
	"PTPN1" => 0,
	"HLA-DMA" => 0,
	"PTPN12" => 0,
	"HLA-DRA" => 0,
	"PTPN6" => 0,
	"PTPRF" => 0,
	"PTPRK" => 0,
	"HACD3" => 0,
	"PTPRC" => 0,
	"MSRA" => 0,
	"HMGCR" => 0,
	"HMOX1" => 0,
	"HMGCS1" => 0,
	"PRKAG2" => 0,
	"ACBD3" => 0,
	"UBE2J1" => 0,
	"EVL" => 0,
	"CERK" => 0,
	"PXMP2" => 0,
	"PXN" => 0,
	"PYCR1" => 0,
	"PYGL" => 0,
	"RAB27A" => 0,
	"HOXA10" => 0,
	"HOXA5" => 0,
	"RAB4A" => 0,
	"RAC2" => 0,
	"RAD9A" => 0,
	"MOK" => 0,
	"RAD51C" => 0,
	"RALA" => 0,
	"RALB" => 0,
	"MUC1" => 0,
	"HPRT1" => 0,
	"HES1" => 0,
	"CHIC2" => 0,
	"UFM1" => 0,
	"TIMM9" => 0,
	"LSR" => 0,
	"RAP1GAP" => 0,
	"RALGDS" => 0,
	"KDM5A" => 0,
	"RASA1" => 0,
	"RB1" => 0,
	"MYC" => 0,
	"MYBL2" => 0,
	"GADD45B" => 0,
	"RELB" => 0,
	"HSPA1A" => 0,
	"DNAJB2" => 0,
	"HSPA4" => 0,
	"MYLK" => 0,
	"MYO10" => 0,
	"RFC2" => 0,
	"HSPB1" => 0,
	"HSPA8" => 0,
	"RFX5" => 0,
	"HSPD1" => 0,
	"RFC5" => 0,
	"RFNG" => 0,
	"DNAJB1" => 0,
	"RGS2" => 0,
	"CTTN" => 0,
	"NCK1" => 0,
	"EPHA3" => 0,
	"EPB41L2" => 0,
	"ICAM3" => 0,
	"ICAM1" => 0,
	"EPHB2" => 0,
	"ID2" => 0,
	"ERBB3" => 0,
	"ERBB2" => 0,
	"NR2F6" => 0,
	"EPRS" => 0,
	"NT5DC2" => 0,
	"DHRS7" => 0,
	"IDE" => 0,
	"ETFB" => 0,
	"NFE2L2" => 0,
	"NFIL3" => 0,
	"ETV1" => 0,
	"ETS1" => 0,
	"NFATC3" => 0,
	"NFATC4" => 0,
	"NFKB2" => 0,
	"NFKBIA" => 0,
	"NFKBIB" => 0,
	"NFKBIE" => 0,
	"EXT1" => 0,
	"IFNAR1" => 0,
	"IGFBP3" => 0,
	"IGF2R" => 0,
	"IGF1R" => 0,
	"EZH2" => 0,
	"PTK2B" => 0,
	"FAH" => 0,
	"FAT1" => 0,
	"ZNF318" => 0,
	"CAB39" => 0,
	"NIT1" => 0,
	"ARID4B" => 0,
	"IGHMBP2" => 0,
	"NMT1" => 0,
	"CNOT4" => 0,
	"NOS3" => 0,
	"PNP" => 0,
	"NOTCH1" => 0,
	"NPC1" => 0,
	"IKBKB" => 0,
	"SLC11A2" => 0,
	"NRAS" => 0,
	"FDFT1" => 0,
	"IL1B" => 0,
	"IL4R" => 0,
	"FGFR4" => 0,
	"FGFR2" => 0,
	"FHL2" => 0,
	"IL13RA1" => 0,
	"FKBP4" => 0,
	"ABHD4" => 0,
	"HIST1H2BK" => 0,
	"NUCB2" => 0,
	"NUP88" => 0,
	"NVL" => 0,
	"ILK" => 0,
	"INPP1" => 0
);

sub main()
{
	# Set $lincs_filter to 1 to enable filtering by the LINCS1000 gene set
	my $lincs_filter = 1;
	
	if(scalar(@ARGV) != 1){
		die "Usage: $0 <CCLE *.gct RPKM file>\n";
	}
	
	my $filename = $ARGV[0];
	
	open(my $INPUT, $filename) or
		die "Unable to open $filename for reading\n";
	
	my @lincs_genes = ();
	
	if($lincs_filter){
		
		@lincs_genes = keys(%lincs);
	
		print STDERR "Found " . scalar(@lincs_genes) . " LINCS gene IDs\n";
	}
	
	my $header;
	
	# Read the three header lines
	if( !($header = <$INPUT>) ){
		die "Unable to read header line #1\n";
	}
	
	if( !($header = <$INPUT>) ){
		die "Unable to read header line #2\n";
	}
	
	if( !($header = <$INPUT>) ){
		die "Unable to read header line #3\n";
	}
	
	my @cell = split /\t/, $header;
	
	if( "Name" ne shift @cell){
		die "Did not read \"Name\" in header\n";
	}
	
	if("Description" ne shift @cell){
		die "Did not read \"Description\" in header\n";
	}
	
	# Reformat the cell line names
	my $num_cell = scalar(@cell);
	
	print STDERR "Found $num_cell cell lines\n";
	
	foreach my $c (@cell){
		
		if($c =~ /^(.*?)\_/){
			$c = "CCLE.$1";
		}
		else{
			die "Unable to reformat cell line: $c\n";
		}
	}
	
	my %X = ();
	
	LINE: while(my $line = <$INPUT>){
		
		chomp($line);
		
		my @data = split /\s+/, $line;
		
		# This id is only used to disambiguate genes with
		# the same name
		my $id = shift @data;
		
		if($id =~ /ENSG0+(.*)/){
			$id = $1;
		}
		
		my $gene = shift @data;
		
		if($lincs_filter){
			
			# Is this gene part of the LINCS1000 set?
			my $lincs_match = 0;
			
			foreach my $g (@lincs_genes){
				
				#if($g =~ /$gene/){
				if($g eq $gene){
					
					# We found a match!
					$lincs_match = 1;
					
					# Count the number of times we
					# matched this gene
					++$lincs{$g};
					
					last;
				}
			}
			
			if($lincs_match == 0){
				next LINE;
			}
		}
		
		if( defined($X{$gene}) ){
		
			# Append the id suffix to disambiguate the
			# gene name
			$gene = $gene . ":" . $id;
			
			if( defined($X{$gene}) ){
				die "Duplicate gene detected: $gene\n";
			}
		}
		
		$X{$gene} = [@data];		
	}
	
	close($INPUT);

	my @name = keys(%X);
	
	print STDERR "Found " . scalar(@name) . " gene names\n";
	
	if($lincs_filter){
		
		my $num_match = 0;
		
		foreach my $g (@lincs_genes){
			
			if($lincs{$g} > 0){
				++$num_match;
			}
			else{
				print STDERR "\tFailed to match LINCS gene: $g\n";
			}
		}
		
		print STDERR "Matched $num_match out of " . 
			scalar(@lincs_genes) . " LINCS1000 genes\n";
	}
	
	# Write the header of gene names
	print "Sample\t" . join("\t", @name) . "\n";
	
	for(my $i = 0;$i < $num_cell;++$i){
		
		print $cell[$i];
		
		foreach my $g (@name){
			
			print "\t$X{$g}[$i]";
		}
		
		print "\n";
	}
}

main();

exit;
